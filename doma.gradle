/*
 * DB接続定義
 */
def dbUrl       = 'jdbc:mysql://localhost:3306/mmsdb'
def dbUser      = 'user1'
def dbPass      = 'user1'
def tableTypes  = 'TABLE,VIEW'
def templateDir = 'domaGenTemplates'

/*
 * 共通ソースコード自動生成
 */
task domaGen << {
	def entityPkg = 'mms.com.doma.entity'
	def daoPkg    = 'mms.com.doma.dao'

    ant.taskdef(resource: 'domagentask.properties', classpath: configurations.domaGenRuntime.asPath)
    ant.gen(url: dbUrl, user: dbUser, password: dbPass, tableTypes: tableTypes, templatePrimaryDir: templateDir) {
        entityConfig(packageName: entityPkg, overwrite: true, overwriteListener: false)
        daoConfig(packageName: daoPkg, overwrite: false)
        sqlConfig(overwrite: true)
    }
}

/*
 * 個別ソースコード自動生成
 */
task domaGenEntity << {
	def entityPkg = 'mms.user'
	def entityNm  = 'GroupByDeptId'
	def sql       = 'select count(*) as cnt from m_user'

    ant.taskdef(resource: 'domagentask.properties', classpath: configurations.domaGenRuntime.asPath)
    ant.gen(url: dbUrl, user: dbUser, password: dbPass, tableTypes: tableTypes, templatePrimaryDir: templateDir) {
        entityConfig(packageName: entityPkg, entityName: entityNm, sql: sql)
    }
}